label           loopa
clear

units           metal
dimension       3
boundary        p p p
atom_style      atomic

variable        A loop 1 20
variable        latparam equal 2.79+0.005*${A}

#-------Define geometry  (2d X 2d) -------------------------------------------------
lattice custom ${latparam} a1 1.0 0.0 0.0 a2 0.0 1.0 0.0 a3 0.0 0.0 1.0 &
                    basis 0.0 0.0 0.0 
region          box prism 0 2 0 2 0 0.5 0 0.5 0.5 units lattice
create_box      1 box
create_atoms    1 box

#-------Define interatomic potential------------------------------------
#pair_style eam/fs
#pair_coeff * * /home/lorenzo/Desktop/lammps_gnn_old-impl/models/Fe_2.eam.fs Fe
pair_style     gnn DimeNet 3.5 128 1 7 8 7 6 -3460.825847482401 0.16576383029449013
pair_coeff	* * /home/lorenzo/Desktop/lammps_gnn_new-impl/testing/models/dimenet.pt 1 26
#pair_style	gnn SchNet 5.0 128 128 3 128 -3460.825847482401 0.16576383029449515
#pair_coeff	* * /home/lorenzo/Desktop/atomico/testing/schnet.pt 1 26

neighbor        2.0 bin
neigh_modify    delay 10 check yes page 100000

#-------Define atom mass (no needed for moelcular statics) -------
mass            1 55.845
#-------Compute-------
dump            1000 all custom 1 dump.* id type x y z fx fy fz
#----- Initial relaxation ------------
thermo          100
thermo_style    custom step pe lx ly lz pxx pyy pzz pxy pxz pyz press

min_style       cg
minimize        1e-12 10e-6 100000000 1000000000

#timestep        0.01
#min_style       fire
#minimize        1e-18 1e-9 100000000 100000000

variable        tmp equal "pe"
variable        pe0 equal ${tmp}
variable        V equal (${latparam}*${latparam}*${latparam}/2)

fix             extra all print 2 "${V} ${pe0}" append ev_gnn.txt
run             1
unfix           extra

next            A
jump            ev.in loopa
